<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íŒŒì¼ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .upload-area { border: 2px dashed #ccc; padding: 20px; margin: 20px 0; }
        .log { background: #f5f5f5; padding: 10px; margin: 10px 0; font-family: monospace; }
        button { padding: 10px 20px; margin: 5px; }
    </style>
</head>
<body>
    <h1>íŒŒì¼ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸</h1>
    
    <div class="upload-area">
        <input type="file" id="fileInput" multiple>
        <button onclick="testUpload()">ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸</button>
    </div>
    
    <div id="log" class="log"></div>
    
    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}<br>`;
            console.log(message);
        }
        
        async function testUpload() {
            const fileInput = document.getElementById('fileInput');
            const files = fileInput.files;
            
            if (files.length === 0) {
                log('âŒ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”');
                return;
            }
            
            log(`ğŸ“ ì„ íƒëœ íŒŒì¼: ${files.length}ê°œ`);
            
            try {
                const formData = new FormData();
                for (let i = 0; i < files.length; i++) {
                    formData.append('files', files[i]);
                    log(`ğŸ“„ íŒŒì¼ ${i+1}: ${files[i].name} (${files[i].size} bytes, ${files[i].type})`);
                }
                
                const url = 'http://localhost:3030/api/ocr/upload';
                log(`ğŸš€ API ìš”ì²­ ì‹œì‘: ${url}`);
                
                const response = await fetch(url, {
                    method: 'POST',
                    body: formData
                });
                
                log(`ğŸ“¡ ì‘ë‹µ ìƒíƒœ: ${response.status} ${response.statusText}`);
                log(`ğŸ“‹ ì‘ë‹µ í—¤ë”: ${JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2)}`);
                
                const responseText = await response.text();
                log(`ğŸ“„ ì‘ë‹µ ë‚´ìš©: ${responseText}`);
                
                if (response.ok) {
                    const data = JSON.parse(responseText);
                    log(`âœ… ì—…ë¡œë“œ ì„±ê³µ! Job ID: ${data.jobId}`);
                } else {
                    log(`âŒ ì—…ë¡œë“œ ì‹¤íŒ¨: ${responseText}`);
                }
                
            } catch (error) {
                log(`ğŸ’¥ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`);
                log(`ğŸ“š ì˜¤ë¥˜ ìŠ¤íƒ: ${error.stack}`);
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë¡œê·¸
        window.addEventListener('load', () => {
            log('ğŸ¯ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            log(`ğŸŒ í˜„ì¬ URL: ${window.location.href}`);
            log(`ğŸ”— ëŒ€ìƒ API: http://localhost:3030/api/ocr/upload`);
        });
    </script>
</body>
</html>