저장 완료됐어요 ✅
아래는 개발팀이 그대로 넣어 쓰면 되는 VNEXIS 손해사정 자동작성 “최종 통합 프롬프트(개발자용)” 입니다.
(모든 최신 규칙 반영: 동적 고지기산점 v2.0, 암 날짜체계, 질환군별 검사규칙, 2단 출력, 전산용 일자별 요약)

🧠 VNEXIS 손해사정 자동작성 – 최종 통합 프롬프트 (개발자용)
0) 공통 원칙
모든 날짜는 항상 yyyy.mm.dd 형식으로 정규화한다.

예시 날짜를 하드코딩하지 않는다. 입력으로 주어진 실제 가입일/진료일만 사용한다.

수임서류(PDF 등)에서 상품별 고지 기준(예: 3.1.5, 3.2.5 …) 이 명시되면 그 기준을 적용한다.

문서에 명시 없을 때만 기본값 3.2.5를 사용하고, 보고서 상단에 “기준 미기재 → 기본규정(3.2.5) 적용” 문구를 자동 표기한다.

1) 입력 (예시 키)
{
  "contract": {
    "contract_date": "YYYY.MM.DD or variants", 
    "product_name": "string",
    "insurer": "string",
    "disclosure_windows": ["5y","1y","3m"]  // 옵션: 없으면 기본 ["5y","2y","3m"] 또는 조직 정책값
  },
  "assignment": {
    "law_firm": "string",
    "adjuster": "string",
    "assigned_date": "YYYY.MM.DD"
  },
  "records": [
    {
      "hospital": "string",
      "date": "YYYY.MM.DD or variants",
      "source": "e.g. OPD/ER/Admission/Path/Imaging",
      "text": "OCR 내용 원문",
      "tags": ["암","입원","수술","AMI","뇌혈관", "..."]  // 있으면 사용
    }
  ]
}
2) 분석 로직 (Core Logic)
2-1) 날짜 정규화
contract.contract_date 및 records[*].date를 파싱하여 전부 yyyy.mm.dd로 통일.

파싱 실패 시 해당 항목은 “미기재”로 표기하고 계산에서 제외.

2-2) 보험가입일 기준 고지의무 기산점 자동판정 v2.0
가입일을 기준으로 동적으로 기간 산출

5년 이내: (가입일 − 5년) ~ 가입일

1년 이내: (가입일 − 1년) ~ 가입일

3개월 이내: (가입일 − 3개월) ~ 가입일

위 세트는 disclosure_windows 입력값이 있으면 그 구성을 우선 적용(예: 3.1.5, 3.2.5 등).

각 기간 내 진료 존재 여부 자동 판정

구간에 진료가 있으면 → “해당 있음 (대표 진료일)”

없으면 → “해당 없음”

대표 진료일 선정 규칙

중대도 우선: 암 / 급성심근경색(AMI) / 뇌혈관 사건 / 수술 / 입원

그 다음 가장 이른 날짜(최초)

항상 yyyy.mm.dd로 출력

2-3) 암 케이스 필수 날짜 체계 (항목 누락 시 ‘미기재’)
검사일(Exam date): 생검/조직 채취 일

보고일(Report date): 병리보고서 발행일

진단일(Dx date): 의무기록에 ‘진단’으로 표기된 최초 날짜

확진일(Confirmation date): 병리 결과로 암이 최초 확정된 날짜(여러 건이면 가장 이른 확정 근거)

판독일(Read date): 판독의/병리과 서명일(보고일과 다를 수 있음)

TNM: 가능 시 cTNM/pTNM. 수술 후 최종병리는 별도 pTNM으로 기재.

2-4) 질환군별 검사결과 반영 규칙
협심증: Chest CT, Cardiac MRI, Coronary CT-Angio, MRA, Coronary angiography(부위·협착률·TIMI)

급성심근경색: 상기 + Troponin, CK-MB, EKG(ST elevation), PCI/스텐트·TIMI

부정맥: EKG 리듬/이상, 24h Holter(종류·빈도·평균/최고/최저 HR)

뇌혈관질환: Brain CT/CTA/MRI/MRA/Angiography(부위·폐색/출혈·범위)

암: 위 암 날짜체계 + 조직소견 + TNM 필수

기타: 기본 혈액/소변 수치는 가급적 생략, CT/MRI/MRA/Angio 등 정밀검사 중심

3) 출력 (항상 2단 구성)
3-A) 확장형 손해사정 보고서 (Full Report)
[보험가입일자] {contract_date}
[보험상품명] {product_name}
[고지의무 기준] {windows_label}  // 예: 3개월·1년·5년
[고지의무 적용기산점 및 진료존재여부]
- 5년 이내: {start_5y} ~ {contract} → {exists_5y} {rep_5y_optional}
- 1년 이내: {start_1y} ~ {contract} → {exists_1y} {rep_1y_optional}
- 3개월 이내: {start_3m} ~ {contract} → {exists_3m} {rep_3m_optional}
{baseline_note_if_missing_rule}  // 기준 미기재 시: “본 보고서는 상품별 고지기준 미기재로 기본규정(3.2.5)을 적용함.”

────────────────────────────
[내원일자] yyyy.mm.dd
[내원경위] (진료 의뢰/증상/배경 요약)
[진단명] (영문 + 한글 + KCD코드)
[검사결과]
 - 검사명(검사일): 결과 요약 / 원어+한글
 - (암인 경우) 암 – 조직검사 결과(날짜 체계):
   · 검사일: … / 보고일: … / 진단일: … / 확진일: … / 판독일: …
   · 조직소견: …
   · TNM: cTNM … / (수술 후 있으면) pTNM …
[치료내용] (수술/처치/약물/내시경 등)
[입원기간] yyyy.mm.dd ~ yyyy.mm.dd / n일
[통원기간] yyyy.mm.dd ~ yyyy.mm.dd / n회
[과거병력] (주요 질환)
[의사소견] (핵심 소견/치료계획)

[분류] ✅ {원발부위명} 원발 + {전이부위명 또는 ‘전이 없음’}
[고지판정] {위반 있음/없음} (근거 요약)
3-B) 결재용 요약본 (보험사 전산용)
📑 손해사정 결재용 요약본
- 내원일시:
- 내원경위:
- 진단병명:
- 검사결과:
   (암의 경우) 검사일 / 보고일 / (있으면) 진단일 / 확진일 / 판독일 / TNM
- 치료내용:
- 통원기간:
- 입원기간:
- 과거병력:
- 의사소견:
- 분류: ✅ {원발} 원발 + {전이} 전이(또는 전이 없음)
- 고지의무 판단: {위반 있음/없음}
3-C) 전산용 일자별 텍스트 요약 (붙여넣기 포맷)
[보험가입일자] {contract_date}
[보험상품명] {product_name}
[고지의무 기준] {windows_label}
[고지의무 적용기산점 및 진료존재여부]
- 5년 이내: {start_5y} ~ {contract} → {exists_5y} {rep_5y_opt}
- 1년 이내: {start_1y} ~ {contract} → {exists_1y} {rep_1y_opt}
- 3개월 이내: {start_3m} ~ {contract} → {exists_3m} {rep_3m_opt}

────────────────────────────
[내원일자] yyyy.mm.dd  (보험가입 X년/개월 이내)
[내원경위] …
[진단명] EN+KR (KCD)
[검사결과] …
[치료내용] …
[입원기간]/[통원기간] …
[의사소견] …
[의무기록 발급처] 병원명
4) 필수 검증 체크리스트
 날짜 전부 yyyy.mm.dd 포맷

 고지 윈도우 동적 계산(수임서류 기준 적용)

 각 윈도우 있음/없음 + 대표 진료일 표기

 암 케이스: 검사일/보고일/진단일/확진일/판독일/TNM 반영

 “분류: ✅ 원발 + 전이(또는 전이 없음)” 한 줄 고정

 결재용 요약본 생성

 전산용 일자별 텍스트 생성

5) LLM 호출 시 필수 요구문 (프롬프트 본문에 삽입)
- 입력 가입일을 기준으로 5년/1년/3개월 윈도우를 동적으로 계산하고 yyyy.mm.dd 형식으로 출력하라.
- 각 윈도우에서 진료 ‘있음/없음’을 판정하고, 있을 경우 대표 진료일(중대도 우선→최초일)을 yyyy.mm.dd로 1개만 표기하라.
- 암 케이스는 반드시 ‘검사일/보고일/진단일/확진일/판독일/TNM’을 포함하라(없으면 ‘미기재’).
- 수임서류에 고지 기준이 명시되면 이를 사용하고, 미기재 시 기본 3.2.5를 적용하며 상단에 이를 명시하라.
- 확장형 보고서, 결재용 요약본, 전산용 일자별 텍스트를 모두 생성하라.
- 예시 날짜를 절대 하드코딩하지 말고 실제 입력 데이터만 사용하라.