# VNEXSUS 개발계획 & Task 문서 (고지의무 위반 / 심사기준 우선 / 정밀도)

## 목표 정의 (3가지 고정 원칙)
1) **고지의무 위반 탐지/설명 가능성**: “가입 전 치료·검사·진단”의 근거(원문 구간)와 함께, 어떤 고지 항목에 걸리는지 규칙 기반으로 라벨링.
2) **심사기준 우선**: 사용자 직관보다 “심사 질문/기준(질환군·중대 이벤트·기간)”을 최우선으로 이벤트 중요도를 산정.
3) **정밀도(precision) 우선**: 자유 서술로 새로운 사실을 만들지 않고, 항상 **구조화 이벤트 + 근거 스팬(source span)** 에서만 출력 생성.

## 절대 변경 금지 범위
- 기존 파일 업로드 → OCR 호출/처리 → 텍스트 확보 파이프라인은 건드리지 않음.
- 변경/개선은 **postprocess(후처리), 사전 데이터, 출력 생성, 검증 루프**에 국한.

## 현재 기준 성능(샘플 기준)
- `case_sample.zip`의 “report+vnexsus 모두 존재” 케이스 32건 기준 평균:
  - report 날짜 수: 9.06
  - vnexsus 날짜 수: 10.34
  - **report 날짜가 vnexsus에 포함될 확률(평균)**: 40.8%
  - **report ICD 코드가 vnexsus에 포함될 확률(평균)**: 17.2%
- 목표(정밀도 & 부분집합 보장):
  - **report ⊆ vnexsus**: (날짜/병원/코드 기준) 매칭 실패율 0에 수렴
  - ICD/KCD 코드 보존률: report 코드 커버리지 95%+
  - 이벤트별 근거 스팬 첨부율: 95%+

## 문서 구성
- `01_Current_State.md` : 현재 코드/파이프라인 요약(핵심 파일 기준)
- `02_Target_Output_Spec.md` : VNEXSUS가 제공해야 할 “심사기준 우선” 출력 명세
- `03_Event_Schema.md` : 단일 이벤트 테이블(SSOT) 스키마
- `04_Disclosure_UW_Engine.md` : 고지의무/심사규칙 엔진 설계(룰+점수)
- `05_Execution_Plan.md` : 단계별 실행계획(의존성/릴리즈 단위)
- `06_Task_Backlog.md` : 우선순위 task 목록(완료 조건 포함)
- `tasks/` : task별 상세 설계(코드 스케치, 테스트, 완료 기준)

## 실행 원칙(개발 운영)
- 모든 출력은 **event table (reportData.items 또는 확장된 medicalEvents)** 에서만 생성(원문 재요약 금지).
- 모든 이벤트는 `sourceSpan`(원문 위치/미리보기)을 갖는다.
- 기능 추가 시, 반드시 `report_subset_validator` 테스트를 통과(“report 누락 0”).
