# VNEXSUS ê°œì„  ì „ëµ ë° í˜¸í™˜ì„± ë³´ì¥ ê³„íš

## ğŸ“‹ ê°œìš”

ë³¸ ë¬¸ì„œëŠ” VNEXSUS ì‹œìŠ¤í…œì˜ ê¸°ì¡´ ê¸°ëŠ¥ì„ ì™„ì „íˆ ë³´ì¥í•˜ë©´ì„œ ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì„ ê°œì„ í•˜ê¸° ìœ„í•œ ì „ëµê³¼ êµ¬ì²´ì ì¸ ì‹¤í–‰ ê³„íšì„ ì œì‹œí•©ë‹ˆë‹¤.

---

## ğŸ¯ ê°œì„  ëª©í‘œ

### 1. í•µì‹¬ ê°œì„  ì˜ì—­
- **ì„±ëŠ¥ ìµœì í™”**: ì²˜ë¦¬ ì†ë„ 30% í–¥ìƒ
- **ì•ˆì •ì„± ê°•í™”**: ì—ëŸ¬ìœ¨ 50% ê°ì†Œ
- **í™•ì¥ì„± ê°œì„ **: ë™ì‹œ ì²˜ë¦¬ ìš©ëŸ‰ 2ë°° ì¦ê°€
- **ëª¨ë‹ˆí„°ë§ ê°•í™”**: ì‹¤ì‹œê°„ ìƒíƒœ ì¶”ì  ë° ì•Œë¦¼

### 2. í˜¸í™˜ì„± ë³´ì¥ ì›ì¹™
- **Zero Downtime**: ê¸°ì¡´ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ì´ ê°œì„ 
- **Backward Compatibility**: ê¸°ì¡´ API ë° ë°ì´í„° í˜•ì‹ ìœ ì§€
- **Gradual Migration**: ë‹¨ê³„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ìœ¼ë¡œ ë¦¬ìŠ¤í¬ ìµœì†Œí™”
- **Rollback Ready**: ì–¸ì œë“  ì´ì „ ë²„ì „ìœ¼ë¡œ ë³µêµ¬ ê°€ëŠ¥

---

## ğŸ” í˜„ì¬ ì‹œìŠ¤í…œ ë¶„ì„

### ê°œì„ ì´ í•„ìš”í•œ ì˜ì—­

#### 1. ì„±ëŠ¥ ë³‘ëª©ì 
```javascript
// í˜„ì¬ ë¬¸ì œì 
- OCR ì²˜ë¦¬: ìˆœì°¨ ì²˜ë¦¬ë¡œ ì¸í•œ ëŒ€ê¸° ì‹œê°„
- AI ì²˜ë¦¬: Claude API í˜¸ì¶œ ì‹œ íƒ€ì„ì•„ì›ƒ ë°œìƒ
- ë©”ëª¨ë¦¬ ì‚¬ìš©: ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ ë¶€ì¡±
- ë°ì´í„°ë² ì´ìŠ¤: ë™ì‹œ ì ‘ê·¼ ì‹œ ë½ ë°œìƒ
```

#### 2. ì•ˆì •ì„± ì´ìŠˆ
```javascript
// í˜„ì¬ ë¬¸ì œì 
- ì™¸ë¶€ API ì˜ì¡´ì„±: Google Vision, Claude API ì¥ì•  ì‹œ ì „ì²´ ì‹œìŠ¤í…œ ì¤‘ë‹¨
- ì—ëŸ¬ ì²˜ë¦¬: ë¶€ë¶„ ì‹¤íŒ¨ ì‹œ ì „ì²´ ì‘ì—… ì‹¤íŒ¨
- ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜: ì‹¤íŒ¨í•œ ì‘ì—… ì¬ì‹œë„ ë¡œì§ ë¶€ì¡±
- ëª¨ë‹ˆí„°ë§: ì‹¤ì‹œê°„ ìƒíƒœ íŒŒì•… ì–´ë ¤ì›€
```

#### 3. í™•ì¥ì„± ì œì•½
```javascript
// í˜„ì¬ ë¬¸ì œì 
- ë‹¨ì¼ ì„œë²„: ìˆ˜í‰ í™•ì¥ ë¶ˆê°€
- ë™ê¸° ì²˜ë¦¬: ë™ì‹œ ìš”ì²­ ì²˜ë¦¬ ì œí•œ
- ë¦¬ì†ŒìŠ¤ ê´€ë¦¬: CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™” ë¶€ì¡±
- ìºì‹±: ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜ ë¶€ì¡±
```

---

## ğŸ› ï¸ ê°œì„  ì „ëµ

### Phase 1: ì•ˆì •ì„± ê°•í™” (í˜¸í™˜ì„± 100% ë³´ì¥)

#### 1.1 ì—ëŸ¬ ì²˜ë¦¬ ë° ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜ ê°•í™”

**ê°œì„  ë‚´ìš©**
```javascript
// ê¸°ì¡´ ì½”ë“œ (ocrController.js)
try {
  const result = await visionService.processDocument(buffer);
  return result;
} catch (error) {
  throw error; // ë‹¨ìˆœ ì—ëŸ¬ ì „íŒŒ
}

// ê°œì„ ëœ ì½”ë“œ
try {
  const result = await visionService.processDocument(buffer);
  return result;
} catch (error) {
  // 1ë‹¨ê³„: ì—ëŸ¬ ë¶„ë¥˜ ë° ë¡œê¹…
  const errorType = this.classifyError(error);
  logger.error('OCR ì²˜ë¦¬ ì‹¤íŒ¨', { error, errorType, jobId });
  
  // 2ë‹¨ê³„: ì¬ì‹œë„ ë¡œì§
  if (errorType === 'TEMPORARY') {
    return await this.retryWithBackoff(
      () => visionService.processDocument(buffer),
      { maxRetries: 3, baseDelay: 1000 }
    );
  }
  
  // 3ë‹¨ê³„: í´ë°± ì²˜ë¦¬
  if (errorType === 'API_LIMIT') {
    return await this.fallbackOCR(buffer);
  }
  
  throw new ProcessingError(error, { recoverable: false });
}
```

**í˜¸í™˜ì„± ë³´ì¥ ë°©ë²•**
- ê¸°ì¡´ API ì‘ë‹µ í˜•ì‹ ì™„ì „ ìœ ì§€
- ì—ëŸ¬ ì½”ë“œ ë° ë©”ì‹œì§€ í˜•ì‹ ë™ì¼ ìœ ì§€
- ê¸°ì¡´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”

#### 1.2 ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹… ì‹œìŠ¤í…œ êµ¬ì¶•

**êµ¬í˜„ ê³„íš**
```javascript
// ìƒˆë¡œìš´ ëª¨ë‹ˆí„°ë§ ë¯¸ë“¤ì›¨ì–´ ì¶”ê°€
class MonitoringMiddleware {
  constructor() {
    this.metrics = new MetricsCollector();
    this.logger = new StructuredLogger();
  }
  
  async trackRequest(req, res, next) {
    const startTime = Date.now();
    const requestId = uuidv4();
    
    // ìš”ì²­ ì‹œì‘ ë¡œê¹…
    this.logger.info('Request started', {
      requestId,
      method: req.method,
      url: req.url,
      userAgent: req.get('User-Agent')
    });
    
    // ì‘ë‹µ ì™„ë£Œ ì‹œ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
    res.on('finish', () => {
      const duration = Date.now() - startTime;
      this.metrics.recordRequest({
        method: req.method,
        statusCode: res.statusCode,
        duration,
        requestId
      });
    });
    
    next();
  }
}

// ê¸°ì¡´ ì•±ì— ë¯¸ë“¤ì›¨ì–´ ì¶”ê°€ (ë¹„ì¹¨ìŠµì )
app.use(new MonitoringMiddleware().trackRequest);
```

**í˜¸í™˜ì„± ë³´ì¥ ë°©ë²•**
- ë¯¸ë“¤ì›¨ì–´ í˜•íƒœë¡œ ì¶”ê°€í•˜ì—¬ ê¸°ì¡´ ë¡œì§ ë³€ê²½ ì—†ìŒ
- ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ ìµœì†Œí™” (< 1ms)
- ì„ íƒì  í™œì„±í™” ê°€ëŠ¥

#### 1.3 ìºì‹± ì‹œìŠ¤í…œ ë„ì…

**êµ¬í˜„ ê³„íš**
```javascript
// Redis ìºì‹± ë ˆì´ì–´ ì¶”ê°€
class CacheService {
  constructor() {
    this.redis = new Redis(process.env.REDIS_URL);
    this.defaultTTL = 3600; // 1ì‹œê°„
  }
  
  async getOCRResult(fileHash) {
    const cached = await this.redis.get(`ocr:${fileHash}`);
    return cached ? JSON.parse(cached) : null;
  }
  
  async setOCRResult(fileHash, result) {
    await this.redis.setex(
      `ocr:${fileHash}`, 
      this.defaultTTL, 
      JSON.stringify(result)
    );
  }
}

// ê¸°ì¡´ OCR ì»¨íŠ¸ë¡¤ëŸ¬ì— ìºì‹± ë¡œì§ ì¶”ê°€
async uploadPdfs(req, res) {
  const files = req.files;
  const fileHashes = files.map(f => this.calculateHash(f.buffer));
  
  // ìºì‹œ í™•ì¸
  const cachedResults = await Promise.all(
    fileHashes.map(hash => this.cacheService.getOCRResult(hash))
  );
  
  // ìºì‹œë˜ì§€ ì•Šì€ íŒŒì¼ë§Œ ì²˜ë¦¬
  const uncachedFiles = files.filter((_, i) => !cachedResults[i]);
  
  if (uncachedFiles.length === 0) {
    // ëª¨ë“  ê²°ê³¼ê°€ ìºì‹œë¨
    return res.json({ jobId, results: cachedResults });
  }
  
  // ê¸°ì¡´ ì²˜ë¦¬ ë¡œì§ ì‹¤í–‰ (ë³€ê²½ ì—†ìŒ)
  const results = await this.processFiles(jobId, uncachedFiles);
  
  // ê²°ê³¼ ìºì‹±
  await Promise.all(
    results.map((result, i) => 
      this.cacheService.setOCRResult(fileHashes[i], result)
    )
  );
  
  return res.json({ jobId, results });
}
```

**í˜¸í™˜ì„± ë³´ì¥ ë°©ë²•**
- ìºì‹œ ë¯¸ìŠ¤ ì‹œ ê¸°ì¡´ ë¡œì§ê³¼ ë™ì¼í•œ ì²˜ë¦¬
- ì‘ë‹µ í˜•ì‹ ì™„ì „ ë™ì¼
- Redis ì¥ì•  ì‹œ ìë™ìœ¼ë¡œ ìºì‹œ ìš°íšŒ

### Phase 2: ì„±ëŠ¥ ìµœì í™” (í˜¸í™˜ì„± ìœ ì§€)

#### 2.1 ë¹„ë™ê¸° ì²˜ë¦¬ ë° í ì‹œìŠ¤í…œ ë„ì…

**êµ¬í˜„ ê³„íš**
```javascript
// Bull Queueë¥¼ ì´ìš©í•œ ì‘ì—… í ì‹œìŠ¤í…œ
const Queue = require('bull');
const ocrQueue = new Queue('OCR processing', process.env.REDIS_URL);

// ê¸°ì¡´ ë™ê¸° ì²˜ë¦¬ë¥¼ ë¹„ë™ê¸°ë¡œ ë³€ê²½
async uploadPdfs(req, res) {
  const files = req.files;
  const jobId = uuidv4();
  
  // ì¦‰ì‹œ ì‘ë‹µ ë°˜í™˜ (ê¸°ì¡´ê³¼ ë™ì¼)
  res.status(202).json({ 
    jobId, 
    status: 'processing',
    message: 'íŒŒì¼ ì²˜ë¦¬ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.'
  });
  
  // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì²˜ë¦¬ (ìƒˆë¡œìš´ ë°©ì‹)
  await ocrQueue.add('process-files', {
    jobId,
    files: files.map(f => ({
      buffer: f.buffer.toString('base64'),
      mimetype: f.mimetype,
      originalname: f.originalname
    }))
  }, {
    attempts: 3,
    backoff: 'exponential',
    delay: 2000
  });
}

// í ì›Œì»¤ (ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤)
ocrQueue.process('process-files', async (job) => {
  const { jobId, files } = job.data;
  
  try {
    // ê¸°ì¡´ ì²˜ë¦¬ ë¡œì§ ì¬ì‚¬ìš©
    const results = await this.processFilesInternal(jobId, files);
    
    // ê²°ê³¼ ì €ì¥ (ê¸°ì¡´ê³¼ ë™ì¼)
    await jobStore.setResult(jobId, results);
    
    // ì™„ë£Œ ì´ë²¤íŠ¸ ë°œí–‰ (ê¸°ì¡´ê³¼ ë™ì¼)
    eventEmitter.emit('ocr-completed', { jobId, results });
    
  } catch (error) {
    await jobStore.setError(jobId, error);
    throw error;
  }
});
```

**í˜¸í™˜ì„± ë³´ì¥ ë°©ë²•**
- í´ë¼ì´ì–¸íŠ¸ ì¸í„°í˜ì´ìŠ¤ ì™„ì „ ë™ì¼ ìœ ì§€
- ìƒíƒœ ì¡°íšŒ API ê¸°ì¡´ í˜•ì‹ ìœ ì§€
- ê²°ê³¼ ë°ì´í„° êµ¬ì¡° ë³€ê²½ ì—†ìŒ

#### 2.2 ë³‘ë ¬ ì²˜ë¦¬ ìµœì í™”

**êµ¬í˜„ ê³„íš**
```javascript
// ê¸°ì¡´ ìˆœì°¨ ì²˜ë¦¬
async processFiles(jobId, files) {
  const results = {};
  
  for (const file of files) {
    results[file.originalname] = await this.processFile(file);
  }
  
  return results;
}

// ê°œì„ ëœ ë³‘ë ¬ ì²˜ë¦¬
async processFiles(jobId, files) {
  const concurrency = Math.min(files.length, 4); // ìµœëŒ€ 4ê°œ ë™ì‹œ ì²˜ë¦¬
  
  const results = await pMap(files, async (file) => {
    return {
      filename: file.originalname,
      result: await this.processFile(file)
    };
  }, { concurrency });
  
  // ê¸°ì¡´ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ í˜¸í™˜ì„± ë³´ì¥
  return results.reduce((acc, { filename, result }) => {
    acc[filename] = result;
    return acc;
  }, {});
}
```

**í˜¸í™˜ì„± ë³´ì¥ ë°©ë²•**
- ê²°ê³¼ ë°ì´í„° êµ¬ì¡° ì™„ì „ ë™ì¼
- ì²˜ë¦¬ ìˆœì„œë§Œ ë³€ê²½, ìµœì¢… ê²°ê³¼ëŠ” ë™ì¼
- ì—ëŸ¬ ì²˜ë¦¬ ë°©ì‹ ìœ ì§€

#### 2.3 ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”

**êµ¬í˜„ ê³„íš**
```javascript
// ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ íŒŒì¼ ì²˜ë¦¬
const stream = require('stream');
const { pipeline } = require('stream/promises');

class FileProcessor extends stream.Transform {
  constructor(options) {
    super({ objectMode: true });
    this.visionService = options.visionService;
  }
  
  async _transform(file, encoding, callback) {
    try {
      // ì²­í¬ ë‹¨ìœ„ë¡œ ì²˜ë¦¬í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì†Œí™”
      const result = await this.processFileStream(file);
      callback(null, result);
    } catch (error) {
      callback(error);
    }
  }
  
  async processFileStream(file) {
    // ëŒ€ìš©ëŸ‰ íŒŒì¼ì„ ì²­í¬ë¡œ ë¶„í•  ì²˜ë¦¬
    if (file.size > 50 * 1024 * 1024) { // 50MB ì´ìƒ
      return await this.processLargeFile(file);
    }
    
    // ê¸°ì¡´ ì²˜ë¦¬ ë°©ì‹ ìœ ì§€ (ì†Œìš©ëŸ‰ íŒŒì¼)
    return await this.visionService.processDocument(file.buffer);
  }
}
```

**í˜¸í™˜ì„± ë³´ì¥ ë°©ë²•**
- ìµœì¢… ê²°ê³¼ í˜•ì‹ ë™ì¼ ìœ ì§€
- ì†Œìš©ëŸ‰ íŒŒì¼ì€ ê¸°ì¡´ ë°©ì‹ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- ëŒ€ìš©ëŸ‰ íŒŒì¼ë§Œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ ì ìš©

### Phase 3: í™•ì¥ì„± ê°œì„  (ì ì§„ì  ì ìš©)

#### 3.1 ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ ë„ì…

**êµ¬í˜„ ê³„íš**
```javascript
// ì„œë¹„ìŠ¤ ë¶„ë¦¬ ê³„íš
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Gateway       â”‚    â”‚   OCR Service   â”‚    â”‚   Rule Service  â”‚
â”‚   (ê¸°ì¡´ ì•±)      â”‚ -> â”‚   (ìƒˆë¡œìš´)       â”‚ -> â”‚   (ìƒˆë¡œìš´)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Report Service â”‚ <- â”‚   AI Service    â”‚ <- â”‚  Queue Service  â”‚
â”‚   (ìƒˆë¡œìš´)       â”‚    â”‚   (ìƒˆë¡œìš´)       â”‚    â”‚   (ìƒˆë¡œìš´)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

// ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ
// 1ë‹¨ê³„: OCR ì„œë¹„ìŠ¤ ë¶„ë¦¬
// 2ë‹¨ê³„: AI ì„œë¹„ìŠ¤ ë¶„ë¦¬  
// 3ë‹¨ê³„: ë£° ì—”ì§„ ì„œë¹„ìŠ¤ ë¶„ë¦¬
// 4ë‹¨ê³„: ë³´ê³ ì„œ ìƒì„± ì„œë¹„ìŠ¤ ë¶„ë¦¬
```

**í˜¸í™˜ì„± ë³´ì¥ ë°©ë²•**
- API Gatewayë¥¼ í†µí•œ ê¸°ì¡´ ì—”ë“œí¬ì¸íŠ¸ ìœ ì§€
- ì„œë¹„ìŠ¤ë³„ ë…ë¦½ ë°°í¬ ê°€ëŠ¥
- ì¥ì•  ì‹œ ê¸°ì¡´ ëª¨ë†€ë¦¬ì‹ ë°©ì‹ìœ¼ë¡œ í´ë°±

#### 3.2 ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

**êµ¬í˜„ ê³„íš**
```javascript
// ì½ê¸° ì „ìš© ë³µì œë³¸ ë„ì…
const masterDB = new Database(process.env.MASTER_DB_URL);
const replicaDB = new Database(process.env.REPLICA_DB_URL);

class DatabaseService {
  async read(query) {
    try {
      return await replicaDB.query(query);
    } catch (error) {
      // ë³µì œë³¸ ì‹¤íŒ¨ ì‹œ ë§ˆìŠ¤í„°ë¡œ í´ë°±
      return await masterDB.query(query);
    }
  }
  
  async write(query) {
    return await masterDB.query(query);
  }
}

// ì¸ë±ìŠ¤ ìµœì í™”
const optimizedIndexes = [
  'CREATE INDEX idx_jobs_status ON jobs(status, created_at)',
  'CREATE INDEX idx_results_job_id ON results(job_id)',
  'CREATE INDEX idx_events_date ON events(event_date, confidence)'
];
```

**í˜¸í™˜ì„± ë³´ì¥ ë°©ë²•**
- ê¸°ì¡´ ì¿¼ë¦¬ ì¸í„°í˜ì´ìŠ¤ ìœ ì§€
- ì ì§„ì  ì¸ë±ìŠ¤ ì¶”ê°€
- ì„±ëŠ¥ ê°œì„ ë§Œ ì œê³µ, ê¸°ëŠ¥ ë³€ê²½ ì—†ìŒ

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

### 1. í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸

#### 1.1 íšŒê·€ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸
```javascript
// ê¸°ì¡´ ê¸°ëŠ¥ ì™„ì „ì„± ê²€ì¦
describe('Backward Compatibility Tests', () => {
  test('OCR API ì‘ë‹µ í˜•ì‹ í˜¸í™˜ì„±', async () => {
    const response = await request(app)
      .post('/api/ocr/upload')
      .attach('files', testPDF);
    
    expect(response.body).toMatchSchema(legacyResponseSchema);
    expect(response.status).toBe(202);
  });
  
  test('ë³´ê³ ì„œ ìƒì„± ê²°ê³¼ í˜¸í™˜ì„±', async () => {
    const result = await reportController.generateReport(testEvents);
    
    expect(result).toHaveProperty('timeline');
    expect(result).toHaveProperty('statistics');
    expect(result.timeline).toBeInstanceOf(Array);
  });
});
```

#### 1.2 ì„±ëŠ¥ íšŒê·€ í…ŒìŠ¤íŠ¸
```javascript
describe('Performance Regression Tests', () => {
  test('OCR ì²˜ë¦¬ ì‹œê°„ì´ ê¸°ì¤€ì¹˜ ì´í•˜', async () => {
    const startTime = Date.now();
    await ocrService.processDocument(testBuffer);
    const duration = Date.now() - startTime;
    
    expect(duration).toBeLessThan(10000); // 10ì´ˆ ì´í•˜
  });
  
  test('ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ê¸°ì¤€ì¹˜ ì´í•˜', async () => {
    const initialMemory = process.memoryUsage().heapUsed;
    await processLargeFile(largeTestFile);
    const finalMemory = process.memoryUsage().heapUsed;
    
    expect(finalMemory - initialMemory).toBeLessThan(500 * 1024 * 1024); // 500MB ì´í•˜
  });
});
```

### 2. í†µí•© í…ŒìŠ¤íŠ¸

#### 2.1 ì—”ë“œíˆ¬ì—”ë“œ í…ŒìŠ¤íŠ¸
```javascript
describe('End-to-End Pipeline Tests', () => {
  test('ì „ì²´ íŒŒì´í”„ë¼ì¸ ì •ìƒ ë™ì‘', async () => {
    // 1. íŒŒì¼ ì—…ë¡œë“œ
    const uploadResponse = await uploadFiles([testPDF]);
    expect(uploadResponse.jobId).toBeDefined();
    
    // 2. OCR ì²˜ë¦¬ ì™„ë£Œ ëŒ€ê¸°
    await waitForCompletion(uploadResponse.jobId);
    
    // 3. í›„ì²˜ë¦¬ ì‹¤í–‰
    const processResult = await postProcess(uploadResponse.jobId);
    expect(processResult.status).toBe('success');
    
    // 4. ë³´ê³ ì„œ ìƒì„±
    const report = await generateReport(processResult.data);
    expect(report.timeline).toBeDefined();
    expect(report.statistics).toBeDefined();
  });
});
```

### 3. ë¶€í•˜ í…ŒìŠ¤íŠ¸

#### 3.1 ë™ì‹œì„± í…ŒìŠ¤íŠ¸
```javascript
describe('Concurrency Tests', () => {
  test('ë™ì‹œ ìš”ì²­ ì²˜ë¦¬ ëŠ¥ë ¥', async () => {
    const concurrentRequests = 10;
    const promises = Array(concurrentRequests).fill().map(() => 
      request(app).post('/api/ocr/upload').attach('files', testPDF)
    );
    
    const results = await Promise.all(promises);
    
    results.forEach(result => {
      expect(result.status).toBe(202);
      expect(result.body.jobId).toBeDefined();
    });
  });
});
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼

### 1. í•µì‹¬ ì§€í‘œ ëª¨ë‹ˆí„°ë§

#### 1.1 ì„±ëŠ¥ ì§€í‘œ
```javascript
const performanceMetrics = {
  // ì²˜ë¦¬ ì‹œê°„
  ocrProcessingTime: 'avg, p95, p99',
  ruleProcessingTime: 'avg, p95, p99',
  aiProcessingTime: 'avg, p95, p99',
  
  // ì²˜ë¦¬ëŸ‰
  requestsPerSecond: 'current, avg',
  filesProcessedPerHour: 'current, avg',
  
  // ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
  cpuUsage: 'current, avg, max',
  memoryUsage: 'current, avg, max',
  diskUsage: 'current, avg, max'
};
```

#### 1.2 ë¹„ì¦ˆë‹ˆìŠ¤ ì§€í‘œ
```javascript
const businessMetrics = {
  // ì„±ê³µë¥ 
  ocrSuccessRate: 'percentage',
  pipelineSuccessRate: 'percentage',
  
  // ì •í™•ë„
  ocrAccuracy: 'percentage',
  ruleFilteringAccuracy: 'percentage',
  
  // ì‚¬ìš©ì ë§Œì¡±ë„
  averageProcessingTime: 'seconds',
  errorRate: 'percentage'
};
```

### 2. ì•Œë¦¼ ì‹œìŠ¤í…œ

#### 2.1 ì„ê³„ê°’ ê¸°ë°˜ ì•Œë¦¼
```javascript
const alertRules = [
  {
    metric: 'ocrProcessingTime.p95',
    threshold: 30000, // 30ì´ˆ
    severity: 'warning',
    message: 'OCR ì²˜ë¦¬ ì‹œê°„ì´ ì„ê³„ê°’ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.'
  },
  {
    metric: 'pipelineSuccessRate',
    threshold: 0.95, // 95%
    operator: 'lt',
    severity: 'critical',
    message: 'íŒŒì´í”„ë¼ì¸ ì„±ê³µë¥ ì´ 95% ë¯¸ë§Œì…ë‹ˆë‹¤.'
  },
  {
    metric: 'memoryUsage',
    threshold: 0.8, // 80%
    severity: 'warning',
    message: 'ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ 80%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.'
  }
];
```

---

## ğŸš€ ë°°í¬ ì „ëµ

### 1. ë¸”ë£¨-ê·¸ë¦° ë°°í¬

#### 1.1 ë°°í¬ í”„ë¡œì„¸ìŠ¤
```bash
# 1ë‹¨ê³„: ìƒˆ ë²„ì „ ë°°í¬ (ê·¸ë¦° í™˜ê²½)
docker-compose -f docker-compose.green.yml up -d

# 2ë‹¨ê³„: í—¬ìŠ¤ ì²´í¬
./scripts/health-check.sh green

# 3ë‹¨ê³„: íŠ¸ë˜í”½ ì „í™˜ (ì ì§„ì )
./scripts/traffic-switch.sh --from blue --to green --percentage 10
./scripts/traffic-switch.sh --from blue --to green --percentage 50
./scripts/traffic-switch.sh --from blue --to green --percentage 100

# 4ë‹¨ê³„: êµ¬ ë²„ì „ ì •ë¦¬
docker-compose -f docker-compose.blue.yml down
```

#### 1.2 ë¡¤ë°± ê³„íš
```bash
# ì¦‰ì‹œ ë¡¤ë°±
./scripts/rollback.sh --immediate

# ì ì§„ì  ë¡¤ë°±
./scripts/traffic-switch.sh --from green --to blue --percentage 100
```

### 2. ì¹´ë‚˜ë¦¬ ë°°í¬

#### 2.1 ë‹¨ê³„ë³„ ë°°í¬
```javascript
const canaryDeployment = {
  stages: [
    { percentage: 5, duration: '30m', criteria: 'errorRate < 1%' },
    { percentage: 25, duration: '1h', criteria: 'errorRate < 0.5%' },
    { percentage: 50, duration: '2h', criteria: 'errorRate < 0.1%' },
    { percentage: 100, duration: 'stable', criteria: 'all metrics normal' }
  ],
  
  rollbackTriggers: [
    'errorRate > 2%',
    'responseTime.p95 > 15s',
    'memoryUsage > 90%'
  ]
};
```

---

## ğŸ“ˆ ì„±ê³¼ ì¸¡ì •

### 1. ê°œì„  ì „í›„ ë¹„êµ ì§€í‘œ

#### 1.1 ì„±ëŠ¥ ì§€í‘œ
| ì§€í‘œ | ê°œì„  ì „ | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|---------|------|-----------|
| OCR ì²˜ë¦¬ ì‹œê°„ | 8ì´ˆ | 5ì´ˆ | í‰ê·  ì²˜ë¦¬ ì‹œê°„ |
| ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹œê°„ | 25ì´ˆ | 18ì´ˆ | ì—”ë“œíˆ¬ì—”ë“œ ì‹œê°„ |
| ë™ì‹œ ì²˜ë¦¬ ìš©ëŸ‰ | 5ê°œ | 20ê°œ | ìµœëŒ€ ë™ì‹œ ìš”ì²­ |
| ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | 2GB | 1GB | í”¼í¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ |

#### 1.2 ì•ˆì •ì„± ì§€í‘œ
| ì§€í‘œ | ê°œì„  ì „ | ëª©í‘œ | ì¸¡ì • ë°©ë²• |
|------|---------|------|-----------|
| ì—ëŸ¬ìœ¨ | 8% | 4% | ì‹¤íŒ¨í•œ ìš”ì²­ ë¹„ìœ¨ |
| ê°€ìš©ì„± | 95% | 99% | ì—…íƒ€ì„ ë¹„ìœ¨ |
| ë³µêµ¬ ì‹œê°„ | 30ë¶„ | 5ë¶„ | ì¥ì•  ë³µêµ¬ ì‹œê°„ |

### 2. ë¹„ì¦ˆë‹ˆìŠ¤ ì„íŒ©íŠ¸

#### 2.1 ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- ì²˜ë¦¬ ì‹œê°„ ë‹¨ì¶•ìœ¼ë¡œ ì‚¬ìš©ì ëŒ€ê¸° ì‹œê°„ ê°ì†Œ
- ì—ëŸ¬ìœ¨ ê°ì†Œë¡œ ì¬ì‹œë„ í•„ìš”ì„± ê°ì†Œ
- ì‹¤ì‹œê°„ ìƒíƒœ ì—…ë°ì´íŠ¸ë¡œ íˆ¬ëª…ì„± ì¦ëŒ€

#### 2.2 ìš´ì˜ íš¨ìœ¨ì„± ê°œì„ 
- ìë™ ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ìˆ˜ë™ ê°œì… ê°ì†Œ
- ëª¨ë‹ˆí„°ë§ ê°•í™”ë¡œ ë¬¸ì œ ì¡°ê¸° ë°œê²¬
- í™•ì¥ì„± ê°œì„ ìœ¼ë¡œ íŠ¸ë˜í”½ ì¦ê°€ ëŒ€ì‘ ê°€ëŠ¥

---

## ğŸ”„ ì§€ì†ì  ê°œì„  ê³„íš

### 1. ì •ê¸° ê²€í†  ë° ìµœì í™”

#### 1.1 ì›”ê°„ ì„±ëŠ¥ ë¦¬ë·°
- í•µì‹¬ ì§€í‘œ íŠ¸ë Œë“œ ë¶„ì„
- ë³‘ëª©ì  ì‹ë³„ ë° ê°œì„  ê³„íš ìˆ˜ë¦½
- ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘ ë° ë°˜ì˜

#### 1.2 ë¶„ê¸°ë³„ ì•„í‚¤í…ì²˜ ë¦¬ë·°
- ê¸°ìˆ  ìŠ¤íƒ ì—…ë°ì´íŠ¸ ê²€í† 
- ìƒˆë¡œìš´ ìµœì í™” ê¸°ë²• ì ìš©
- ë³´ì•ˆ ì·¨ì•½ì  ì ê²€ ë° íŒ¨ì¹˜

### 2. ê¸°ìˆ  ë¶€ì±„ ê´€ë¦¬

#### 2.1 ì½”ë“œ í’ˆì§ˆ ê°œì„ 
- ì •ê¸°ì ì¸ ì½”ë“œ ë¦¬íŒ©í† ë§
- í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í–¥ìƒ
- ë¬¸ì„œí™” ì—…ë°ì´íŠ¸

#### 2.2 ì˜ì¡´ì„± ê´€ë¦¬
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ì—…ë°ì´íŠ¸
- ë³´ì•ˆ íŒ¨ì¹˜ ì ìš©
- ì„±ëŠ¥ ê°œì„ ëœ ëŒ€ì•ˆ ê¸°ìˆ  ê²€í† 

---

ì´ ê°œì„  ì „ëµì„ í†µí•´ ê¸°ì¡´ ê¸°ëŠ¥ì˜ ì™„ì „í•œ í˜¸í™˜ì„±ì„ ë³´ì¥í•˜ë©´ì„œë„ ì‹œìŠ¤í…œì˜ ì„±ëŠ¥, ì•ˆì •ì„±, í™•ì¥ì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ì—ì„œëŠ” êµ¬ì²´ì ì¸ ê°œë°œ ê³„íšê³¼ í…ŒìŠ¤íŠ¸ ì „ëµì„ ìˆ˜ë¦½í•˜ê² ìŠµë‹ˆë‹¤.