<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VNEXSUS 시스템 아키텍처 다이어그램</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.8;
            font-size: 1.1em;
        }
        
        .diagram-container {
            padding: 30px;
            background: #f8f9fa;
        }
        
        .controls {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .control-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .control-btn.active {
            background: #e74c3c;
        }
        
        #architecture-svg {
            width: 100%;
            height: 800px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: white;
        }
        
        .legend {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border: 1px solid #ddd;
        }
        
        .legend h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .legend-item {
            display: inline-block;
            margin: 5px 15px;
            font-size: 14px;
        }
        
        .legend-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 8px;
            vertical-align: middle;
            border-radius: 3px;
        }
        
        /* SVG 스타일 */
        .module-box {
            fill: #3498db;
            stroke: #2980b9;
            stroke-width: 2;
            rx: 8;
            ry: 8;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .module-box:hover {
            fill: #5dade2;
            stroke-width: 3;
        }
        
        .ai-module {
            fill: #e74c3c;
            stroke: #c0392b;
        }
        
        .ai-module:hover {
            fill: #ec7063;
        }
        
        .data-module {
            fill: #2ecc71;
            stroke: #27ae60;
        }
        
        .data-module:hover {
            fill: #58d68d;
        }
        
        .api-module {
            fill: #f39c12;
            stroke: #e67e22;
        }
        
        .api-module:hover {
            fill: #f8c471;
        }
        
        .module-text {
            fill: white;
            font-family: 'Segoe UI', sans-serif;
            font-size: 12px;
            font-weight: 600;
            text-anchor: middle;
            dominant-baseline: middle;
        }
        
        .connection-line {
            stroke: #7f8c8d;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
        }
        
        .data-flow {
            stroke: #e74c3c;
            stroke-width: 3;
            stroke-dasharray: 5,5;
            animation: dash 2s linear infinite;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: -10;
            }
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>VNEXSUS 시스템 아키텍처</h1>
            <p>AI 기반 의료 보고서 생성 시스템 - 전체 구조 및 데이터 플로우</p>
        </div>
        
        <div class="diagram-container">
            <div class="controls">
                <button class="control-btn" onclick="showDataFlow()">데이터 플로우 표시</button>
                <button class="control-btn" onclick="highlightAI()">AI 모듈 강조</button>
                <button class="control-btn" onclick="resetView()">기본 뷰</button>
                <button class="control-btn" onclick="showDetails()">상세 정보</button>
            </div>
            
            <svg id="architecture-svg" viewBox="0 0 1200 700">
                <!-- 화살표 마커 정의 -->
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                            refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#7f8c8d" />
                    </marker>
                    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" 
                            refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />
                    </marker>
                </defs>
                
                <!-- 배경 그리드 -->
                <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                    <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#f0f0f0" stroke-width="1"/>
                </pattern>
                <rect width="100%" height="100%" fill="url(#grid)" />
                
                <!-- 레이어 구분 배경 -->
                <rect x="50" y="50" width="1100" height="120" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1" rx="5" opacity="0.3"/>
                <text x="70" y="40" fill="#2c3e50" font-size="14" font-weight="bold">프론트엔드 레이어</text>
                
                <rect x="50" y="200" width="1100" height="150" fill="#e8f5e9" stroke="#4caf50" stroke-width="1" rx="5" opacity="0.3"/>
                <text x="70" y="190" fill="#2c3e50" font-size="14" font-weight="bold">API 및 컨트롤러 레이어</text>
                
                <rect x="50" y="380" width="1100" height="180" fill="#fff3e0" stroke="#ff9800" stroke-width="1" rx="5" opacity="0.3"/>
                <text x="70" y="370" fill="#2c3e50" font-size="14" font-weight="bold">AI 처리 레이어</text>
                
                <rect x="50" y="590" width="1100" height="80" fill="#fce4ec" stroke="#e91e63" stroke-width="1" rx="5" opacity="0.3"/>
                <text x="70" y="580" fill="#2c3e50" font-size="14" font-weight="bold">데이터 레이어</text>
                
                <!-- 프론트엔드 모듈들 -->
                <rect class="module-box" x="100" y="80" width="120" height="60" data-tooltip="React 기반 웹 인터페이스"/>
                <text class="module-text" x="160" y="110">Frontend UI</text>
                
                <rect class="module-box" x="250" y="80" width="120" height="60" data-tooltip="파일 업로드 및 처리"/>
                <text class="module-text" x="310" y="110">File Upload</text>
                
                <rect class="module-box" x="400" y="80" width="120" height="60" data-tooltip="실시간 진행 상황 표시"/>
                <text class="module-text" x="460" y="110">Progress UI</text>
                
                <rect class="module-box" x="550" y="80" width="120" height="60" data-tooltip="보고서 뷰어 및 다운로드"/>
                <text class="module-text" x="610" y="110">Report Viewer</text>
                
                <!-- API 레이어 -->
                <rect class="module-box api-module" x="100" y="230" width="120" height="60" data-tooltip="Express.js 기반 REST API"/>
                <text class="module-text" x="160" y="260">API Gateway</text>
                
                <rect class="module-box api-module" x="250" y="230" width="120" height="60" data-tooltip="파일 업로드 처리"/>
                <text class="module-text" x="310" y="260">Upload Handler</text>
                
                <rect class="module-box api-module" x="400" y="230" width="120" height="60" data-tooltip="OCR 텍스트 추출"/>
                <text class="module-text" x="460" y="260">OCR Service</text>
                
                <rect class="module-box api-module" x="550" y="230" width="120" height="60" data-tooltip="보고서 생성 컨트롤러"/>
                <text class="module-text" x="610" y="260">Report Controller</text>
                
                <rect class="module-box api-module" x="700" y="230" width="120" height="60" data-tooltip="검증 및 품질 관리"/>
                <text class="module-text" x="760" y="260">Validation API</text>
                
                <!-- AI 처리 레이어 -->
                <rect class="module-box ai-module" x="100" y="410" width="140" height="60" data-tooltip="GPT-4o Mini 전처리 AI"/>
                <text class="module-text" x="170" y="440">GPT-4o Mini</text>
                <text class="module-text" x="170" y="455" font-size="10">(Preprocessing)</text>
                
                <rect class="module-box ai-module" x="270" y="410" width="140" height="60" data-tooltip="GPT-4o Mini 보고서 생성"/>
                <text class="module-text" x="340" y="440">GPT-4o Mini</text>
                <text class="module-text" x="340" y="455" font-size="10">(Report Gen)</text>
                
                <rect class="module-box ai-module" x="440" y="410" width="120" height="60" data-tooltip="Claude 3 Haiku 서비스"/>
                <text class="module-text" x="500" y="440">Claude 3</text>
                <text class="module-text" x="500" y="455" font-size="10">Haiku</text>
                
                <rect class="module-box ai-module" x="590" y="410" width="120" height="60" data-tooltip="GPT-4o 최종 검증"/>
                <text class="module-text" x="650" y="440">GPT-4o</text>
                <text class="module-text" x="650" y="455" font-size="10">Validation</text>
                
                <rect class="module-box ai-module" x="740" y="410" width="120" height="60" data-tooltip="O1-Mini 품질 검증"/>
                <text class="module-text" x="800" y="440">O1-Mini</text>
                <text class="module-text" x="800" y="455" font-size="10">Quality Check</text>
                
                <rect class="module-box ai-module" x="890" y="410" width="120" height="60" data-tooltip="프롬프트 최적화 엔진"/>
                <text class="module-text" x="950" y="440">Prompt</text>
                <text class="module-text" x="950" y="455" font-size="10">Optimizer</text>
                
                <!-- 데이터 레이어 -->
                <rect class="module-box data-module" x="100" y="610" width="120" height="40" data-tooltip="업로드된 파일 저장소"/>
                <text class="module-text" x="160" y="630">File Storage</text>
                
                <rect class="module-box data-module" x="250" y="610" width="120" height="40" data-tooltip="처리 결과 캐시"/>
                <text class="module-text" x="310" y="630">Cache DB</text>
                
                <rect class="module-box data-module" x="400" y="610" width="120" height="40" data-tooltip="생성된 보고서 저장"/>
                <text class="module-text" x="460" y="630">Report DB</text>
                
                <rect class="module-box data-module" x="550" y="610" width="120" height="40" data-tooltip="시스템 로그 및 메트릭"/>
                <text class="module-text" x="610" y="630">Logs & Metrics</text>
                
                <rect class="module-box data-module" x="700" y="610" width="120" height="40" data-tooltip="설정 및 템플릿"/>
                <text class="module-text" x="760" y="630">Config Store</text>
                
                <!-- 연결선들 -->
                <!-- Frontend to API -->
                <line class="connection-line" x1="160" y1="140" x2="160" y2="230"/>
                <line class="connection-line" x1="310" y1="140" x2="310" y2="230"/>
                <line class="connection-line" x1="460" y1="140" x2="460" y2="230"/>
                <line class="connection-line" x1="610" y1="140" x2="610" y2="230"/>
                
                <!-- API to AI -->
                <line class="connection-line" x1="310" y1="290" x2="170" y2="410"/>
                <line class="connection-line" x1="460" y1="290" x2="340" y2="410"/>
                <line class="connection-line" x1="610" y1="290" x2="500" y2="410"/>
                <line class="connection-line" x1="760" y1="290" x2="650" y2="410"/>
                <line class="connection-line" x1="760" y1="290" x2="800" y2="410"/>
                
                <!-- AI to Data -->
                <line class="connection-line" x1="170" y1="470" x2="160" y2="610"/>
                <line class="connection-line" x1="340" y1="470" x2="310" y2="610"/>
                <line class="connection-line" x1="500" y1="470" x2="460" y2="610"/>
                <line class="connection-line" x1="650" y1="470" x2="610" y2="610"/>
                <line class="connection-line" x1="800" y1="470" x2="760" y2="610"/>
                
                <!-- AI 모듈 간 연결 -->
                <line class="connection-line" x1="240" y1="440" x2="270" y2="440"/>
                <line class="connection-line" x1="410" y1="440" x2="440" y2="440"/>
                <line class="connection-line" x1="560" y1="440" x2="590" y2="440"/>
                <line class="connection-line" x1="710" y1="440" x2="740" y2="440"/>
                <line class="connection-line" x1="860" y1="440" x2="890" y2="440"/>
                
                <!-- 데이터 플로우 라인 (숨김 상태) -->
                <g id="data-flow-lines" style="display: none;">
                    <line class="data-flow" x1="160" y1="140" x2="170" y2="410" marker-end="url(#arrowhead-red)"/>
                    <line class="data-flow" x1="240" y1="440" x2="270" y2="440" marker-end="url(#arrowhead-red)"/>
                    <line class="data-flow" x1="410" y1="440" x2="500" y2="440" marker-end="url(#arrowhead-red)"/>
                    <line class="data-flow" x1="560" y1="440" x2="650" y2="440" marker-end="url(#arrowhead-red)"/>
                    <line class="data-flow" x1="710" y1="440" x2="800" y2="440" marker-end="url(#arrowhead-red)"/>
                    <line class="data-flow" x1="650" y1="470" x2="610" y2="140" marker-end="url(#arrowhead-red)"/>
                </g>
                
                <!-- 성능 메트릭 표시 -->
                <g id="performance-metrics" style="display: none;">
                    <rect x="900" y="100" width="200" height="120" fill="white" stroke="#3498db" stroke-width="2" rx="5"/>
                    <text x="910" y="120" fill="#2c3e50" font-size="14" font-weight="bold">성능 메트릭</text>
                    <text x="910" y="140" fill="#27ae60" font-size="12">토큰 절약: 35%</text>
                    <text x="910" y="155" fill="#27ae60" font-size="12">처리 시간: -40%</text>
                    <text x="910" y="170" fill="#27ae60" font-size="12">정확도: +15%</text>
                    <text x="910" y="185" fill="#27ae60" font-size="12">API 호출: -25%</text>
                    <text x="910" y="200" fill="#e74c3c" font-size="12">평균 응답: 2.3초</text>
                </g>
            </svg>
            
            <div class="legend">
                <h3>범례</h3>
                <div class="legend-item">
                    <span class="legend-color" style="background-color: #3498db;"></span>
                    일반 모듈
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background-color: #e74c3c;"></span>
                    AI 모듈
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background-color: #2ecc71;"></span>
                    데이터 모듈
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background-color: #f39c12;"></span>
                    API 모듈
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background-color: #7f8c8d;"></span>
                    연결선
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background-color: #e74c3c; border: 2px dashed #c0392b;"></span>
                    데이터 플로우
                </div>
            </div>
        </div>
    </div>
    
    <div class="tooltip" id="tooltip"></div>
    
    <script>
        // 툴팁 기능
        const tooltip = document.getElementById('tooltip');
        const elements = document.querySelectorAll('[data-tooltip]');
        
        elements.forEach(element => {
            element.addEventListener('mouseenter', (e) => {
                const tooltipText = e.target.getAttribute('data-tooltip');
                tooltip.textContent = tooltipText;
                tooltip.style.opacity = '1';
            });
            
            element.addEventListener('mousemove', (e) => {
                tooltip.style.left = e.pageX + 10 + 'px';
                tooltip.style.top = e.pageY - 30 + 'px';
            });
            
            element.addEventListener('mouseleave', () => {
                tooltip.style.opacity = '0';
            });
        });
        
        // 컨트롤 기능들
        function showDataFlow() {
            const dataFlowLines = document.getElementById('data-flow-lines');
            dataFlowLines.style.display = dataFlowLines.style.display === 'none' ? 'block' : 'none';
        }
        
        function highlightAI() {
            const aiModules = document.querySelectorAll('.ai-module');
            aiModules.forEach(module => {
                module.style.filter = module.style.filter ? '' : 'drop-shadow(0 0 10px #e74c3c)';
            });
        }
        
        function resetView() {
            document.getElementById('data-flow-lines').style.display = 'none';
            document.getElementById('performance-metrics').style.display = 'none';
            document.querySelectorAll('.ai-module').forEach(module => {
                module.style.filter = '';
            });
        }
        
        function showDetails() {
            const metrics = document.getElementById('performance-metrics');
            metrics.style.display = metrics.style.display === 'none' ? 'block' : 'none';
        }
        
        // 모듈 클릭 이벤트
        document.querySelectorAll('.module-box').forEach(box => {
            box.addEventListener('click', function() {
                const tooltip = this.getAttribute('data-tooltip');
                alert(`모듈 정보:\n${tooltip}`);
            });
        });
    </script>
</body>
</html>